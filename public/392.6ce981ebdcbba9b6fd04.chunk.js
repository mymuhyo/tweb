"use strict";(this.webpackChunktweb=this.webpackChunktweb||[]).push([[392],{6392:(e,t,n)=>{n.r(t),n.d(t,{default:()=>w});var a=n(4755),o=n(4874),r=n(810),s=n(3083),l=n(4489),i=n(2325),u=n(144),h=n(5565),d=n(3512),c=n(1447),p=n(2521),m=n(2738);let E,g,_,b,C=null,v=null,y=null;const f=()=>{setTimeout((()=>{null==_||_.remove(),null==b||b.remove()}),300)},S=new o.Z("page-authCode",!0,(()=>{S.pageEl.querySelector(".input-wrapper").append(g.container);const e=S.pageEl.querySelector(".phone-edit");(0,m.fc)(e,(()=>r.default.mount()))}),(e=>{if(C=e,v){E.value="";const e=document.createEvent("HTMLEvents");e.initEvent("input",!1,!0),E.dispatchEvent(e)}else v=S.pageEl.getElementsByClassName("phone")[0],y=S.pageEl.getElementsByClassName("sent-type")[0];const t=C.type.length;let o,r;g||(g=new l.Z({label:"Code",name:(0,u.a)(),length:t,onFill:e=>{(e=>{E.setAttribute("disabled","true");const t={phone_number:C.phone_number,phone_code_hash:C.phone_code_hash,phone_code:e};d.Z.managers.apiManager.invokeApi("auth.signIn",t,{ignoreErrors:!0}).then((e=>{switch(e._){case"auth.authorization":d.Z.managers.apiManager.setUser(e.user),n.e(781).then(n.bind(n,5436)).then((e=>{e.default.mount()})),f();break;case"auth.authorizationSignUpRequired":n.e(813).then(n.bind(n,8339)).then((e=>{e.default.mount({phone_number:C.phone_number,phone_code_hash:C.phone_code_hash})})),f()}})).catch((e=>{return t=void 0,a=void 0,r=function*(){let t=!1;switch(e.type){case"SESSION_PASSWORD_NEEDED":t=!0,e.handled=!0,yield(yield n.e(442).then(n.bind(n,9437))).default.mount(),setTimeout((()=>{E.value=""}),300);break;case"PHONE_CODE_EXPIRED":E.classList.add("error"),(0,h.Z)(g.label,(0,i.ag)("PHONE_CODE_EXPIRED"));break;case"PHONE_CODE_EMPTY":case"PHONE_CODE_INVALID":E.classList.add("error"),(0,h.Z)(g.label,(0,i.ag)("PHONE_CODE_INVALID"));break;default:g.label.innerText=e.type}t||g.select(),E.removeAttribute("disabled")},new((o=void 0)||(o=Promise))((function(e,n){function s(e){try{i(r.next(e))}catch(e){n(e)}}function l(e){try{i(r.throw(e))}catch(e){n(e)}}function i(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(s,l)}i((r=r.apply(t,a||[])).next())}));var t,a,o,r}))})(e)}}),E=g.input),g.options.length=t,v.innerText=C.phone_number;const m=C.type;switch(m._){case"auth.sentCodeTypeSms":o="Login.Code.SentSms";break;case"auth.sentCodeTypeApp":o="Login.Code.SentInApp";break;case"auth.sentCodeTypeCall":o="Login.Code.SentCall";break;case"auth.sentCodeTypeFragmentSms":o="PhoneNumber.Code.Fragment.Info";const e=document.createElement("a");(0,p.Z)(e),e.href=m.url,r=[e];break;default:o="Login.Code.SentUnknown",r=[m._]}return(0,h.Z)(y,(0,i.ag)(o,r)),d.Z.managers.appStateManager.pushToState("authState",{_:"authStateAuthCode",sentCode:e}),(()=>{const e=S.pageEl.querySelector(".auth-image"),t=a.Z.isMobile?100:166;if("auth.sentCodeTypeFragmentSms"===C.type._){e.firstElementChild&&(null==_||_.remove(),_=void 0,e.replaceChildren());const n=document.createElement("div");return n.classList.add("media-sticker-wrapper"),e.append(n),c.Z.loadAnimationAsAsset({container:n,loop:!0,autoplay:!0,width:t,height:t},"jolly_roger").then((e=>(b=e,c.Z.waitForFirstFrame(e)))).then((()=>{}))}return e.firstElementChild&&(null==b||b.remove(),b=void 0,e.replaceChildren()),_=new s.Z(g,t),e.append(_.container),_.load()})()}),(()=>{E.focus()})),w=S}}]);
//# sourceMappingURL=392.6ce981ebdcbba9b6fd04.chunk.js.map